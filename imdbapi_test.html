<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IMDB API Test</title>
</head>
<body>
    <section id="card"></section>
    <script>
        let api_key = "5941d4436aff4a93f3f11e86cb336bec";
        let config;
        fetch(`https://api.themoviedb.org/3/configuration?api_key=${api_key}`)
            .then(response => {
	            return response.json();
            })
            .then(data => {
                config = {...data};
                // console.log("config inside", config);
                return data;
            })
            .catch(error => {
                console.error(error);
            })
        ;
        fetch(`https://api.themoviedb.org/3/movie/popular?api_key=${api_key}&language=en-US&page=1`)
            .then(response => {
	            return response.json();
            })
            .then(data => {
                let {results} = data;
                // console.log(results);
                results.forEach(result => {
                    let image = config.images.secure_base_url + config.images.poster_sizes[3] + result.poster_path;
                    console.log(result.id, result.title, image);
                    let card_image = document.createElement("img");
                    card_image.setAttribute("src", image);
                    card_image.setAttribute("alt", result.title);
                    card_image.setAttribute("name", result.id);
                    card_image.setAttribute("class", "game-card");
                    document.getElementById("card").append(card_image);
                })
                return data;
            })
            .catch(error => {
                console.error(error);
            })
        ;
        // fetch("https://movies-tvshows-data-imdb.p.rapidapi.com/?type=get-popular-movies&page=1&year=2020", {
        //     "method": "GET",
        //     "headers": {
        //         "x-rapidapi-host": "movies-tvshows-data-imdb.p.rapidapi.com",
        //         "x-rapidapi-key": "fcb68e3121mshda62c37ba5eb449p10e057jsn884e901c7796"
        //     }})
        //     .then(response => {
	    //         return response.json();
        //     })
        //     .then(data => {
        //         console.log(data);
        //         return data;
        //     })
        //     .catch(error => {
        //         console.error(error);
        //     })
        // ;
        // let saved = [];
        // fetch(`https://imdb-api.com/en/API/MostPopularMovies/k_68k3xnp8`)
        //     .then(response => {
        //         return response.json();
        //     })
        //     .then(data => {
        //         let {items} = data;
        //         items.forEach(card => {
        //             saved.push(card);
        //         });
        //         print();
        //         return data;
        //     })
        //     .catch(error => {
        //         console.error("Request failed", error)
        //     })
        // ;
        // function print() {
        //     saved.forEach(card => {
        //         console.log(card);
        //         // let imageID = card.image.split("/").pop();
        //         // let image = `https://imdb-api.com/Images/384x528/${imageID}`;
        //         // let image = card.image.replace("M", "original");
        //         // console.log(image);
        //         let card_image = document.createElement("img");
        //         card_image.setAttribute("src", card.image);
        //         card_image.setAttribute("alt", card.title);
        //         card_image.setAttribute("name", card.id);
        //         card_image.setAttribute("class", "game-card");
        //         document.getElementById("card").append(card_image);
        //     });
        // }
    </script>
</body>
</html>